!function(t){var n={};t.itemSelector={define:function(t,e){n[t]=e},require:function(t,e){if(t instanceof Array){var i=[];for(var l in t){var o=n[t[l]];"function"==typeof o&&(o=o(),n[t[l]]=o),i.push(o)}e.apply(null,i)}else if("string"==typeof t){var o=n[t];return"function"==typeof o&&(o=o(),n[t]=o),o}},clear:function(){n={}}}}(window),function(){itemSelector.define("DEF_CONFIG",function(){return{singleton:!1,lazyLoad:!0,title:"item selector",width:null,height:"400px",data:[],icon:"fa fa-star",onShow:function(t,n){},afterClose:function(t,n){},onSubmit:function(t,n){return!0}}})}(),function(){itemSelector.define("EVENTS",function(){return{AFTER_RENDER:"after.render.item-selector"}})}(),function(){itemSelector.define("util",function(){var t=1;return{generateId:function(){return t++}}})}(),function(){itemSelector.define("core",function(){function t(t){var n=t.id||i.generateId(),l=null;return function(){var e=t.title,i=t.height,o=t.width,a='            <div data-modal-id="'+n+'" class="modal fade" tabindex="-1">              <div style="width: '+o+';" class="modal-dialog">                <div class="modal-content">                    <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">×</button>                        <h4 class="modal-title">'+e+'</h4>                    </div>                    <div style="padding: 35px; height: '+i+';" class="modal-body">                        <table style="width: 100%; height:100%; text-align: center; font-size: 12px;">                            <tbody>                                <tr>                                    <td style="width: 45%;">                                        <div style="height: 100%; overflow: auto; text-align: left; margin-bottom: 0;" class="panel panel-default">                                            <div class="panel-body">                                                <input class="form-control search-left" placeholder="输入搜索内容……">                                                <br/>                                                <div class="btn-group">                                                    <button class="select-all btn btn-info btn-xs"><i class="fa fa-check-square"></i></button>                                                    <button class="de-select-all btn btn-info btn-xs"><i class="fa fa-square"></i></button>                                                    <button class="open-all btn btn-info btn-xs"><i class="fa fa-plus-square"></i></button>                                                    <button class="close-all btn btn-info btn-xs"><i class="fa fa-minus-square"></i></button>                                                </div>                                                <br/>                                                <br/>                                                <div class="tree tree-left"></div>                                            </div>                                        </div>                                    </td>                                    <td>                                        <button style="width: 30px;" class="left-all btn btn-sm btn-danger"><i class="fa fa-angle-double-left"></i></button>                                        <br/>                                        <br/>                                        <button style="width: 30px;" class="left btn btn-sm btn-danger"><i class="fa fa-angle-left"></i></button>                                        <br/>                                        <br/>                                        <button style="width: 30px;" class="right btn btn-sm btn-success"><i class="fa fa-angle-right"></i></button>                                        <br/>                                        <br/>                                        <button style="width: 30px;" class="right-all btn btn-sm btn-success"><i class="fa fa-angle-double-right"></i></button>                                        <br/>                                    </td>                                    <td style="width: 45%;">                                        <div style="height: 100%; overflow: auto; text-align: left; margin-bottom: 0;" class="panel panel-default">                                            <div class="panel-body">                                                <input class="form-control search-right" placeholder="输入搜索内容……">                                                <br/>                                                <div class="btn-group">                                                    <button class="select-all btn btn-info btn-xs"><i class="fa fa-check-square"></i></button>                                                    <button class="de-select-all btn btn-info btn-xs"><i class="fa fa-square"></i></button>                                                    <button class="open-all btn btn-info btn-xs"><i class="fa fa-plus-square"></i></button>                                                    <button class="close-all btn btn-info btn-xs"><i class="fa fa-minus-square"></i></button>                                                </div>                                                <br/>                                                <br/>                                                <div class="tree tree-right"></div>                                            </div>                                        </div>                                    </td>                                </tr>                            </tbody>                        </table>                    </div>                    <div class="modal-footer">                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>                        <button type="button" class="btn btn-success">提交</button>                    </div>                </div>              </div>            </div>';l=$(a)}(),function(){function n(t){function n(t,i){return $.each(e,function(e,l,o){if(l.id&&l.pid==t){l.text||(console.warn('filed "text" is null or empty'),console.log(l));var a={id:l.id,text:l.text,icon:l.icon,data:l,children:[]};i.push(a),n(a.id,a.children)}}),i}var e=$.extend({},t,!0);return n(null,[])}function i(n,e){var i={types:{"default":{icon:t.icon}},checkbox:{keep_selected_style:!0},plugins:["checkbox","contextmenu","search","types","wholerow"]},l=n.jstree($.extend({core:{data:e,check_callback:!0}},i,!0)).jstree(!0);return l}function o(t,n){var e=!1;n.keyup(function(){e&&clearTimeout(e),e=setTimeout(function(){var e=n.val();t.search(e.trim())},250)})}function a(t,n){t.on("click",function(){var t=$(this).parents(".panel-body").find(".tree").jstree(!0);n(t)})}function c(t){var n=[];return $.each(t,function(t,e,i){e.isSelected&&n.push(e.id)}),n}function s(t){return t.get_checked(!0)||t.get_selected(!0)}function r(t){var n=t.get_selected();t.select_all();var e=t.get_selected(!0);return t.deselect_all(),t.select_node(n),e}function d(t){var n=r(t),e=[];return $.each(n,function(t,n,i){e.push(n.data)}),e}function u(t,n,e){$.each(e,function(e,i,l){function o(e){n.get_node(e.parent)||o(t.get_node(e.parent)),n.get_node(e.id)||n.create_node(e.parent,{id:e.id,text:e.text,icon:e.icon,data:e.data})}o(i)}),t.delete_node(e)}function f(){var t=s(E);u(E,S,t)}function b(){var t=s(S);u(S,E,t)}var h=l.find(".tree-left"),v=l.find(".search-left"),m=l.find(".tree-right"),p=l.find(".search-right"),g=l.find("button.left"),y=l.find("button.left-all"),x=l.find("button.right"),_=l.find("button.right-all"),w=n(t.data),k=[],S=i(h,w),E=i(m,k);window.leftTree=S,window.rightTree=E,o(S,v),o(E,p),a(l.find("button.select-all"),function(t){t.select_all()}),a(l.find("button.de-select-all"),function(t){t.deselect_all()}),a(l.find("button.open-all"),function(t){t.open_all()}),a(l.find("button.close-all"),function(t){t.close_all()}),g.on("click",function(){f()}),y.on("click",function(){E.select_all(),f()}),x.on("click",function(){b()}),_.on("click",function(){S.select_all(),b()}),l.on(e.AFTER_RENDER,function(){S.select_node(c(t.data)),b()});var q={show:function(){l.modal("show")},hide:function(){l.modal("hide")}},T={setTitle:function(t){l.find(".modal-header .modal-title").html(t)},destroy:function(){},reload:function(){}};null!=t.buttons&&t.buttons instanceof Array?$.each(t.buttons,function(t,n,e){var i=$("<button></button>");t.id&&i.attr("id",t.id),i.addClass(t.cls?t.cls:"btn btn-default"),i.text(t.text||"click"),$.isFunction(t.callback)&&i.on("click",function(){t.callback(T,d(E))&&q.hide()})}):l.find(".modal-footer .btn-success").click(function(){return $.isFunction(t.onSubmit)?void(t.onSubmit(T,d(E))&&q.hide()):void q.hide()}),l.on("show.bs.modal",function(){t.onShow(T,l)}),l.on("hidden.bs.modal",function(){t.afterClose(T,l)})}(),$(document.body).append(l),setTimeout(function(){l.trigger(e.AFTER_RENDER)},200),n}var n=itemSelector.require("DEF_CONFIG"),e=itemSelector.require("EVENTS"),i=itemSelector.require("util");return function(e){function i(){var n=t(l);$(this).attr("data-toggle","modal"),$(this).attr("data-target","[data-modal-id="+n+"]"),o=!0}var l=$.extend({},n,e,!0);if(l.lazyLoad){var o=!1;this.on("click",function(){o||i.call(this)})}else i.call(this)}})}(),function(t){var n=itemSelector.require("core");t.fn.extend({itemSelector:function(t){t?n.call(this,t):n.call(this,{})}})}(jQuery);